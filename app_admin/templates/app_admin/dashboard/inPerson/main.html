    {% extends 'app_admin/dashboard/da_base.html' %}
    {% load static %}

    {% block head_style_plugins %}
        <!-- Plugins CSS -->
        <link rel="stylesheet" type="text/css" href="{% static 'assets/vendor/font-awesome/css/all.min.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'assets/vendor/bootstrap-icons/bootstrap-icons.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'assets/vendor/choices/css/choices.min.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'assets/vendor/overlay-scrollbar/css/overlayscrollbars.min.css' %}">
    {% endblock %}

    {% block admin_main_content %}
    <!-- Page main content START -->
    <div class="page-content-wrapper border">

        <!-- Title -->
        <div class="row mb-3">
            <div class="col-12 d-sm-flex justify-content-between align-items-center">
                <h1 class="h3 mb-2 mb-sm-0">Neighborhood Matching Dashboard</h1>
                <a href="#" class="btn btn-sm btn-primary mb-0">Generate Reports</a>
            </div>
        </div>

        <!-- Stats boxes START -->
        <div class="row g-4 mb-4">
            <!-- Tutors with location -->
            <div class="col-sm-6 col-lg-3">
                <div class="text-center p-4 bg-primary bg-opacity-10 border border-primary rounded-3">
                    <h6>Tutors with Location</h6>
                    <h2 class="mb-0 fs-1 text-primary">{{ total_tutors }}</h2>
                    <a href="{% url 'my_admin:in_person_tutor_list' %}?has_location=yes" class="btn btn-sm btn-primary-soft mt-2 mb-0">View</a>
                </div>
            </div>

            <!-- Students with location -->
            <div class="col-sm-6 col-lg-3">
                <div class="text-center p-4 bg-success bg-opacity-10 border border-success rounded-3">
                    <h6>Students with Location</h6>
                    <h2 class="mb-0 fs-1 text-success">{{ total_students }}</h2>
                    <a href="{% url 'my_admin:in_person_student_list' %}?has_location=yes" class="btn btn-sm btn-success-soft mt-2 mb-0">View</a>
                </div>
            </div>

            <!-- Missing location -->
            <div class="col-sm-6 col-lg-3">
                <div class="text-center p-4 bg-warning bg-opacity-15 border border-warning rounded-3">
                    <h6>Missing Location</h6>
                    <h2 class="mb-0 fs-1 text-warning">{{ missing_location_count }}</h2>
    {#                <a href="{% url 'my_admin:user_neighborhood_missing' %}" class="btn btn-sm btn-warning-soft mt-2 mb-0">View</a>#}
                    <a href="#" class="btn btn-sm btn-warning-soft mt-2 mb-0">View</a>
                </div>
            </div>

            <!-- Potential matches -->
            <div class="col-sm-6 col-lg-3">
                <div class="text-center p-4 bg-info bg-opacity-10 border border-info rounded-3">
                    <h6>Potential Matches</h6>
                    <h2 class="mb-0 fs-1 text-info">{{ potential_matches }}</h2>
                    <a href="#" class="btn btn-sm btn-info-soft mt-2 mb-0">Analyze</a>
                </div>
            </div>
        </div>
        <!-- Stats boxes END -->

        <!-- Recent Activity Card START -->
        <div class="card bg-transparent border">

            <!-- Card header START -->
            <div class="card-header bg-light border-bottom">
                <h5 class="mb-0">Recent Location Updates</h5>
            </div>
            <!-- Card header END -->

            <!-- Card body START -->
            <div class="card-body">
                <div class="table-responsive border-0">
                    <table class="table table-dark-gray align-middle p-4 mb-0 table-hover">
                        <thead>
                            <tr>
                                <th scope="col" class="border-0 rounded-start">User</th>
                                <th scope="col" class="border-0">Type</th>
                                <th scope="col" class="border-0">Location</th>
                                <th scope="col" class="border-0">Method</th>
                                <th scope="col" class="border-0">Radius</th>
                                <th scope="col" class="border-0">Updated</th>
                                <th scope="col" class="border-0 rounded-end">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for update in recent_updates %}
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar avatar-xs flex-shrink-0">
                                            <img class="avatar-img rounded-circle" src="{{ update.user.profile.photo.url|default:'/static/assets/images/avatar/placeholder.jpg' }}" alt="avatar">
                                        </div>
                                        <div class="ms-2">
                                            <h6 class="mb-0">{{ update.user.get_full_name }}</h6>
                                            <small class="text-body">{{ update.user.email }}</small>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span class="badge {% if update.user_type == 'tutor' %}bg-primary{% else %}bg-info{% endif %} bg-opacity-10 text-{% if update.user_type == 'tutor' %}primary{% else %}info{% endif %}">
                                        {{ update.get_user_type_display }}
                                    </span>
                                </td>
                                <td>
                                    {% if update.city %}
                                        {{ update.city }}, {{ update.get_country_display }}
                                    {% else %}
                                        <span class="text-danger">Not set</span>
                                    {% endif %}
                                </td>
                                <td>{{ update.get_meeting_method_display }}</td>
                                <td>{{ update.meeting_radius|default:"-" }} km</td>
                                <td>{{ update.last_modified|date:"M d, Y" }}</td>
                                <td>
                                    <a href="{% url 'my_admin:user_neighborhood_detail' update.id %}" class="btn btn-sm btn-primary-soft">View Matches</a>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="7" class="text-center">No recent updates found</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- Card body END -->

            <!-- Card footer START -->
            <div class="card-footer bg-transparent pt-0">
                <div class="d-sm-flex justify-content-sm-between align-items-sm-center">
                    <p class="mb-0 text-center text-sm-start">Showing 1 to 5 of {{ recent_updates.count }} entries</p>
                    <a href="#" class="btn btn-sm btn-primary-soft mb-0">View All Activity</a>
                </div>
            </div>
            <!-- Card footer END -->
        </div>
        <!-- Recent Activity Card END -->

        <!-- Map Visualization Card START -->
        <div class="card bg-transparent border mt-4">
            <div class="card-header bg-light border-bottom">
                <h5 class="mb-0">User Distribution Map</h5>
            </div>
            <div class="card-body">
                <div id="map" style="height: 400px; background-color: #f8f9fa; border-radius: 0.5rem;">
                    <div class="text-center py-5">
                        <h5>Map Visualization</h5>
                        <p class="mb-0">Interactive map showing user locations would appear here</p>
                    </div>
                </div>
            </div>
        </div>
        <!-- Map Visualization Card END -->
    </div>
    <!-- Page main content END -->
    {% endblock %}

    {% block scripts_vendors %}
        <!-- Vendors -->
        <script src="{% static 'assets/vendor/choices/js/choices.min.js' %}"></script>
        <script src="{% static 'assets/vendor/overlay-scrollbar/js/overlayscrollbars.min.js' %}"></script>
        <!-- Mapbox would be included here for actual implementation -->
    {% endblock %}