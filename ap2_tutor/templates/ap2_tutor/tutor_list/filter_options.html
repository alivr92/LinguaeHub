<form id="fSearch" name="fSearch" class="bg-white border border-gray-200 rounded-xl shadow-sm p-4 mb-4"
      action="{% url 'provider:tutor_list' %}" method="GET">

    <input type="hidden" name="page" value="1">

    <!-- Primary Search Row - Separate Section -->
    <div class="row g-3 align-items-center d-flex bg-light-subtle rounded-3 p-3 border">
        <!-- Search Input - This will expand to fill remaining space -->
        <div class="col-xxl-6 col-xl-5 col-lg-5 col-md-8 col-sm-12 rounded position-relative mb-1">
{#            <div class="input-group">#}
{#                <span class="input-group-text bg-white border-end-0">#}
{#                    <i class="bi bi-search text-primary"></i>#}
{#                </span>#}
{#                    <input class="form-control border-start-0 bg-body"#}
{#                           type="search"#}
{#                           name="keySearch"#}
{#                           placeholder="Search by name, keyword, or specialty..."#}
{#                           value="{{ request.GET.keySearch }}">#}
{#            </div>#}
            <div class="input-group">
                <span class="input-group-text border-end-0"><i class="bi bi-search text-primary"></i></span>
                <input class="form-control border-start-0 bg-body"
                       type="search"
                       name="keySearch"
                       placeholder="Search by name, keyword, or specialty..."
                       value="{{ request.GET.keySearch }}">
            </div>
        </div>

        <!-- Sort Options -->
        <div class="col-xxl-2 col-xl-3 col-lg-3 col-md-4 col-sm-12 mb-1">
            <select name="sort_by" class="form-select js-choice border-0 z-index-9 bg-transparent"
                    aria-label=".form-select-sm" data-search-enabled="false">
                <option value="">🎯 Recommended</option>
                <option value="newest" {% if request.GET.sort_by == "newest" %}selected{% endif %}>
                    <i class="bi bi-rocket-takeoff text-primary me-2"></i>Newest First
                </option>
                <option value="oldest" {% if request.GET.sort_by == "oldest" %}selected{% endif %}>
                    <i class="bi bi-clock-history text-secondary me-2"></i>Oldest First
                </option>
                <option value="price_low" {% if request.GET.sort_by == "price_low" %}selected{% endif %}>
                    <i class="bi bi-arrow-up-circle text-success me-2"></i>Price: Low to High
                </option>
                <option value="price_high" {% if request.GET.sort_by == "price_high" %}selected{% endif %}>
                    <i class="bi bi-arrow-down-circle text-danger me-2"></i>Price: High to Low
                </option>
                <option value="rating" {% if request.GET.sort_by == "rating" %}selected{% endif %}>
                    <i class="bi bi-star-fill text-warning me-2"></i>Highest Rating
                </option>
                <option value="students" {% if request.GET.sort_by == "students" %}selected{% endif %}>
                    <i class="bi bi-people-fill text-info me-2"></i>Most Students
                </option>
                <option value="sessions" {% if request.GET.sort_by == "sessions" %}selected{% endif %}>
                    <i class="bi bi-collection-play text-purple me-2"></i>Most Sessions
                </option>
                <option value="reviews" {% if request.GET.sort_by == "reviews" %}selected{% endif %}>
                    <i class="bi bi-chat-square-text text-pink me-2"></i>Most Reviews
                </option>
            </select>
        </div>

        <!-- Button Group -->
        <div class="col-xxl-4 col-xl-4 col-lg-4 col-md-12 col-sm-12">
            <div class="row g-2 py-1">
                <!-- Filter button -->
                <div class="col-md-6 col-12 col-sm-6">
                    <button type="submit" class="btn btn-primary w-100">Search</button>
                </div>

                <!-- Reset button -->
                <div class="col-md-6 col-12 col-sm-6">
                    <button type="button"
                            class="btn btn-secondary w-100"
                            onclick="filterManager.clearAllFilters()">
                        Clear All
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Filter Options Grid - Optimized for different screen sizes -->
    <div class="row g-3 align-items-end my-2">

        <!-- Skills Filter -->
{#        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">#}
{#            <label class="form-label small fw-semibold mb-2">Teaching Skills</label>#}
{#            <select name="skills" class="form-select js-choice"#}
{#                    data-max-item-count="3" multiple="multiple"#}
{#                    data-remove-item-button="true"#}
{#            >#}
{#                <option value="">All Skills</option>#}
{#                {% for skill in s_skills %}#}
{#                    <option value="{{ skill }}"#}
{#                            {% if skill in request.GET.skills %}selected{% endif %}>#}
{#                        {{ skill }}#}
{#                    </option>#}
{#                {% endfor %}#}
{#            </select>#}
{#        </div>#}

        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">
            <label class="form-label small fw-semibold mb-2">Teaching Skills</label>
            <select name="skills" class="form-select js-choice">
                <option value="">All Skills</option>
                {% for skill in s_skills %}
                    <option value="{{ skill }}" {% if request.GET.skills == skill %}selected{% endif %}>
                        {{ skill }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Skill Level Filter -->
{#        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">#}
{#            <label class="form-label small fw-semibold mb-2">Skill Level</label>#}
{#            <select name="sSkillLevel" class="form-select js-choice" data-search-enabled="false"#}
{#                    data-max-item-count="3" #}
{#                    data-remove-item-button="true"#}
{#            >#}
{#                <option value="">All Levels</option>#}
{#                {% for level in s_language_levels %}#}
{#                    <option value="{{ level.name }}"#}
{#                            {% if level.name in request.GET.sSkillLevel %}selected{% endif %}>#}
{#                        {{ level.name|capfirst }}#}
{#                    </option>#}
{#                {% endfor %}#}
{#            </select>#}
{#        </div>#}

        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">
            <label class="form-label small fw-semibold mb-2">Skill Level</label>
            <select name="sSkillLevel" class="form-select js-choice" data-search-enabled="false">
                <option value="">All Levels</option>
                {% for level in s_language_levels %}
                    <option value="{{ level.name }}" {% if request.GET.sSkillLevel == level.name %}selected{% endif %}>
                        {{ level.name|capfirst }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Gender Filter -->
        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">
            <label class="form-label small fw-semibold mb-2">Gender</label>
            <select name="gender" class="form-select form-select-md js-choice" data-search-enabled="false">
                <option value="">All Genders</option>
                {% for gender in s_gender %}
                    <option value="{{ gender }}" {% if request.GET.gender == gender %}selected{% endif %}>
                        {{ gender|capfirst }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- ⭐⭐⭐⭐⭐ Rating Filter -->
        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">
            <label class="form-label small fw-semibold text-gray-600 mb-2">Minimum Rating</label>
            <select name="sRate" class="form-select form-select-md js-choice" data-search-enabled="false">
                <option value="">Any Rating</option>
                <option value="5" {% if request.GET.sRate == "5" %}selected{% endif %}>5 Stars</option>
                <option value="4.5" {% if request.GET.sRate == "4.5" %}selected{% endif %}>4.5+ Stars & up</option>
                <option value="4" {% if request.GET.sRate == "4" %}selected{% endif %}>4+ Stars & up</option>
                <option value="3" {% if request.GET.sRate == "3" %}selected{% endif %}>3+ Stars & up</option>
            </select>

        </div>

        <!-- Teaching Method -->
        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">
            <label class="form-label small fw-semibold text-gray-600 mb-2">Teaching Method</label>
            <select name="meeting_method" class="form-select js-choice" data-search-enabled="false">
                <option value="">Any Method</option>
                <option value="online" {% if request.GET.meeting_method == "online" %}selected{% endif %}>
{#                    📡#}
                    <i class="bi bi-laptop me-2"></i>Online Only
                </option>
                <option value="in_person" {% if request.GET.meeting_method == "in_person" %}selected{% endif %}>
                    <i class="bi bi-person me-2"></i>In-Person Only
                </option>
                <option value="hybrid" {% if request.GET.meeting_method == "hybrid" %}selected{% endif %}>
{#                    <i class="bi bi-person-workspace me-1"></i>🔄 Hybrid#}
                    <i class="bi bi-person-workspace me-2"></i>Hybrid
                </option>
            </select>
        </div>

        <!-- Country Filter -->
        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">
            <label class="form-label small fw-semibold text-gray-600 mb-2">Country</label>
            <select name="country" class="form-select js-choice" data-search-enabled="true">
                <option value="">All Countries</option>
                {% for code, name in countries %}
                    <option value="{{ code }}" {% if request.GET.country == code %}selected{% endif %}>
                        {{ name }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Price Range -->
        <div class="col-xxl-2 col-xl-3 col-lg-4 col-md-6 col-sm-6">
            <label class="form-label small fw-semibold text-gray-600 mb-2">Hourly Price</label>
            <div class="dropdown">
                <button class="btn btn-outline-gray-400 btn-md w-100 dropdown-toggle d-flex justify-content-between align-items-center"
                        type="button" data-bs-toggle="dropdown" aria-expanded="false"
                        data-bs-auto-close="outside" id="priceRangeDropdown">
                    <span class="text-truncate">
                        {% if request.GET.min_price and request.GET.max_price %}
                            ${{ request.GET.min_price }} - ${{ request.GET.max_price }}
                        {% else %}
                            Price Range
                        {% endif %}
                    </span>
                </button>
                <div class="dropdown-menu p-4 shadow-lg border-0" style="min-width: 360px;">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h6 class="mb-0 fw-semibold text-gray-800">Hourly Price Range</h6>
                        <button type="button" class="btn-close" data-bs-dismiss="dropdown" aria-label="Close"></button>
                    </div>
                    <div id="priceSlider" class="mb-4 mt-3"></div>

                    <!-- price range inputs -->
                    <div class="row g-3 mb-4">
                        <div class="col-6">
                            <label class="form-label small fw-semibold text-gray-600">Minimum</label>
                            <div class="input-group input-group-md">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="minPriceEdit" step="1"
                                       min="{{ min_price }}" max="{{ max_price }}" value="{{ request.GET.min_price|default:'' }}">
                            </div>
                        </div>
                        <div class="col-6">
                            <label class="form-label small fw-semibold text-gray-600">Maximum</label>
                            <div class="input-group input-group-md">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control " id="maxPriceEdit" step="1"
                                       min="{{ min_price }}" max="{{ max_price }}" value="{{ request.GET.max_price|default:'' }}">
                            </div>
                        </div>
                    </div>

                    <div class="d-flex justify-content-between gap-2">
                        <button type="button" class="btn btn-outline-secondary btn-sm flex-fill"
                                onclick="priceSliderManager.resetPriceRange()">
                            <i class="fas fa-redo me-2"></i>Reset
                        </button>
                        <button type="button" class="btn btn-primary btn-sm flex-fill"
                                onclick="priceSliderManager.applyPriceRange()">
                            <i class="fas fa-check me-2"></i>Apply
                        </button>
                    </div>
                    <input type="hidden" name="min_price" id="minPriceInput" value="{{ request.GET.min_price|default:'' }}">
                    <input type="hidden" name="max_price" id="maxPriceInput" value="{{ request.GET.max_price|default:'' }}">
                </div>
            </div>
        </div>


    </div>

    <!-- Active Filters Display -->
    <div class="row mt-4" id="activeFiltersContainer" style="display: none;">
        <div class="col-12">
            <div class="d-flex flex-wrap gap-2 align-items-center">
                <span class="text-gray-600 fw-semibold small me-2">Active filters:</span>
                <!-- Active filters will appear here -->
            </div>
        </div>
    </div>

</form>
